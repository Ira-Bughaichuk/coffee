
let products = [
  {
    "categories": "coffee",
    "image": '../assets/images/coffee-1.jpg',
    "tittle": "Irish coffee",
    "description":
      "Fragrant black coffee with Jameson Irish whiskey and whipped milk",
    "price": "7.00",
    "sizes": {
      "s": {
        "size": "200 ml",
        "add-price": "0.00"
      },
      "m": {
        "size": "300 ml",
        "add-price": "0.50"
      },
      "l": {
        "size": "400 ml",
        "add-price": "1.00"
      }
    },
    "additives": [
      {
        "name": "Sugar",
        "add-price": "0.50"
      },
      {
        "name": "Cinnamon",
        "add-price": "0.50"
      },
      {
        "name": "Syrup",
        "add-price": "0.50"
      }
    ]
  },
  {
    "categories": "coffee",
    "image": '../assets/images/coffee-2.jpg',
    "tittle": "Kahlua coffee",
    "description":
      "Classic coffee with milk and Kahlua liqueur under a cap of frothed milk",
    "price": "7.00",
    "sizes": {
      "s": {
        "size": "200 ml",
        "add-price": "0.00"
      },
      "m": {
        "size": "300 ml",
        "add-price": "0.50"
      },
      "l": {
        "size": "400 ml",
        "add-price": "1.00"
      }
    },
    "additives": [
      {
        "name": "Sugar",
        "add-price": "0.50"
      },
      {
        "name": "Cinnamon",
        "add-price": "0.50"
      },
      {
        "name": "Syrup",
        "add-price": "0.50"
      }
    ]
  },
  {
    "categories": "coffee",
    "image": '../assets/images/coffee-3.jpg',
    "tittle": "Honey raf",
    "description": "Espresso with frothed milk, cream and aromatic honey",
    "price": "5.50",
    "sizes": {
      "s": {
        "size": "200 ml",
        "add-price": "0.00"
      },
      "m": {
        "size": "300 ml",
        "add-price": "0.50"
      },
      "l": {
        "size": "400 ml",
        "add-price": "1.00"
      }
    },
    "additives": [
      {
        "name": "Sugar",
        "add-price": "0.50"
      },
      {
        "name": "Cinnamon",
        "add-price": "0.50"
      },
      {
        "name": "Syrup",
        "add-price": "0.50"
      }
    ]
  },
  {
    "categories": "coffee",
    "image": '../assets/images/coffee-4.jpg',
    "tittle": "Ice cappuccino",
    "description": "Cappuccino with soft thick foam in summer version with ice",
    "price": "5.00",
    "sizes": {
      "s": {
        "size": "200 ml",
        "add-price": "0.00"
      },
      "m": {
        "size": "300 ml",
        "add-price": "0.50"
      },
      "l": {
        "size": "400 ml",
        "add-price": "1.00"
      }
    },
    "additives": [
      {
        "name": "Sugar",
        "add-price": "0.50"
      },
      {
        "name": "Cinnamon",
        "add-price": "0.50"
      },
      {
        "name": "Syrup",
        "add-price": "0.50"
      }
    ]
  },
  {
    "categories": "coffee",
    "image": "../assets/images/coffee-5.jpg",
    "tittle": "Espresso",
    "description": "Classic black coffee",
    "price": "4.50",
    "sizes": {
      "s": {
        "size": "200 ml",
        "add-price": "0.00"
      },
      "m": {
        "size": "300 ml",
        "add-price": "0.50"
      },
      "l": {
        "size": "400 ml",
        "add-price": "1.00"
      }
    },
    "additives": [
      {
        "name": "Sugar",
        "add-price": "0.50"
      },
      {
        "name": "Cinnamon",
        "add-price": "0.50"
      },
      {
        "name": "Syrup",
        "add-price": "0.50"
      }
    ]
  },
  {
    "categories": "coffee",
    "image": "../assets/images/coffee-6.jpg",
    "tittle": "Latte",
    "description":
      "Espresso coffee with the addition of steamed milk and dense milk foam",
    "price": "5.50",
    "sizes": {
      "s": {
        "size": "200 ml",
        "add-price": "0.00"
      },
      "m": {
        "size": "300 ml",
        "add-price": "0.50"
      },
      "l": {
        "size": "400 ml",
        "add-price": "1.00"
      }
    },
    "additives": [
      {
        "name": "Sugar",
        "add-price": "0.50"
      },
      {
        "name": "Cinnamon",
        "add-price": "0.50"
      },
      {
        "name": "Syrup",
        "add-price": "0.50"
      }
    ]
  },
  {
    "categories": "coffee",
    "image": "../assets/images/coffee-7.jpg",
    "tittle": "Latte macchiato",
    "description": "Espresso with frothed milk and chocolate",
    "price": "5.50",
    "sizes": {
      "s": {
        "size": "200 ml",
        "add-price": "0.00"
      },
      "m": {
        "size": "300 ml",
        "add-price": "0.50"
      },
      "l": {
        "size": "400 ml",
        "add-price": "1.00"
      }
    },
    "additives": [
      {
        "name": "Sugar",
        "add-price": "0.50"
      },
      {
        "name": "Cinnamon",
        "add-price": "0.50"
      },
      {
        "name": "Syrup",
        "add-price": "0.50"
      }
    ]
  },
  {
    "categories": "coffee",
    "image": "../assets/images/coffee-8.jpg",
    "tittle": "Coffee with cognac",
    "description": "Fragrant black coffee with cognac and whipped cream",
    "price": "6.50",
    "sizes": {
      "s": {
        "size": "200 ml",
        "add-price": "0.00"
      },
      "m": {
        "size": "300 ml",
        "add-price": "0.50"
      },
      "l": {
        "size": "400 ml",
        "add-price": "1.00"
      }
    },
    "additives": [
      {
        "name": "Sugar",
        "add-price": "0.50"
      },
      {
        "name": "Cinnamon",
        "add-price": "0.50"
      },
      {
        "name": "Syrup",
        "add-price": "0.50"
      }
    ]
  },
  {
    "categories": "tea",
    "image": "../assets/images/tea-1.jpg",
    "tittle": "Moroccan",
    "description":
      "Fragrant black tea with the addition of tangerine, cinnamon, honey, lemon and mint",
    "price": "4.50",
    "sizes": {
      "s": {
        "size": "200 ml",
        "add-price": "0.00"
      },
      "m": {
        "size": "300 ml",
        "add-price": "0.50"
      },
      "l": {
        "size": "400 ml",
        "add-price": "1.00"
      }
    },
    "additives": [
      {
        "name": "Sugar",
        "add-price": "0.50"
      },
      {
        "name": "Lemon",
        "add-price": "0.50"
      },
      {
        "name": "Syrup",
        "add-price": "0.50"
      }
    ]
  },
  {
    "categories": "tea",
    "image": "../assets/images/tea-2.jpg",
    "tittle": "Ginger",
    "description": "Original black tea with fresh ginger, lemon and honey",
    "price": "5.00",
    "sizes": {
      "s": {
        "size": "200 ml",
        "add-price": "0.00"
      },
      "m": {
        "size": "300 ml",
        "add-price": "0.50"
      },
      "l": {
        "size": "400 ml",
        "add-price": "1.00"
      }
    },
    "additives": [
      {
        "name": "Sugar",
        "add-price": "0.50"
      },
      {
        "name": "Lemon",
        "add-price": "0.50"
      },
      {
        "name": "Syrup",
        "add-price": "0.50"
      }
    ]
  },
  {
    "categories": "tea",
    "image": "../assets/images/tea-3.jpg",
    "tittle": "Cranberry",
    "description": "Invigorating black tea with cranberry and honey",
    "price": "5.00",
    "sizes": {
      "s": {
        "size": "200 ml",
        "add-price": "0.00"
      },
      "m": {
        "size": "300 ml",
        "add-price": "0.50"
      },
      "l": {
        "size": "400 ml",
        "add-price": "1.00"
      }
    },
    "additives": [
      {
        "name": "Sugar",
        "add-price": "0.50"
      },
      {
        "name": "Lemon",
        "add-price": "0.50"
      },
      {
        "name": "Syrup",
        "add-price": "0.50"
      }
    ]
  },
  {
    "categories": "tea",
    "image": "../assets/images/tea-4.jpg",
    "tittle": "Sea buckthorn",
    "description":
      "Toning sweet black tea with sea buckthorn, fresh thyme and cinnamon",
    "price": "5.50",
    "sizes": {
      "s": {
        "size": "200 ml",
        "add-price": "0.00"
      },
      "m": {
        "size": "300 ml",
        "add-price": "0.50"
      },
      "l": {
        "size": "400 ml",
        "add-price": "1.00"
      }
    },
    "additives": [
      {
        "name": "Sugar",
        "add-price": "0.50"
      },
      {
        "name": "Lemon",
        "add-price": "0.50"
      },
      {
        "name": "Syrup",
        "add-price": "0.50"
      }
    ]
  },
  {
    "categories": "dessert",
    "image": "../assets/images/dessert-1.jpg",
    "tittle": "Marble cheesecake",
    "description":
      "Philadelphia cheese with lemon zest on a light sponge cake and red currant jam",
    "price": "3.50",
    "sizes": {
      "s": {
        "size": "50 g",
        "add-price": "0.00"
      },
      "m": {
        "size": "100 g",
        "add-price": "0.50"
      },
      "l": {
        "size": "200 g",
        "add-price": "1.00"
      }
    },
    "additives": [
      {
        "name": "Berries",
        "add-price": "0.50"
      },
      {
        "name": "Nuts",
        "add-price": "0.50"
      },
      {
        "name": "Jam",
        "add-price": "0.50"
      }
    ]
  },
  {
    "categories": "dessert",
    "image": "../assets/images/dessert-2.jpg",
    "tittle": "Red velvet",
    "description": "Layer cake with cream cheese frosting",
    "price": "4.00",
    "sizes": {
      "s": {
        "size": "50 g",
        "add-price": "0.00"
      },
      "m": {
        "size": "100 g",
        "add-price": "0.50"
      },
      "l": {
        "size": "200 g",
        "add-price": "1.00"
      }
    },
    "additives": [
      {
        "name": "Berries",
        "add-price": "0.50"
      },
      {
        "name": "Nuts",
        "add-price": "0.50"
      },
      {
        "name": "Jam",
        "add-price": "0.50"
      }
    ]
  },
  {
    "categories": "dessert",
    "image": "../assets/images/dessert-3.jpg",
    "tittle": "Cheesecakes",
    "description":
      "Soft cottage cheese pancakes with sour cream and fresh berries and sprinkled with powdered sugar",
    "price": "4.50",
    "sizes": {
      "s": {
        "size": "50 g",
        "add-price": "0.00"
      },
      "m": {
        "size": "100 g",
        "add-price": "0.50"
      },
      "l": {
        "size": "200 g",
        "add-price": "1.00"
      }
    },
    "additives": [
      {
        "name": "Berries",
        "add-price": "0.50"
      },
      {
        "name": "Nuts",
        "add-price": "0.50"
      },
      {
        "name": "Jam",
        "add-price": "0.50"
      }
    ]
  },
  {
    "categories": "dessert",
    "image": "../assets/images/dessert-4.jpg",
    "tittle": "Creme brulee",
    "description":
      "Delicate creamy dessert in a caramel basket with wild berries",
    "price": "4.00",
    "sizes": {
      "s": {
        "size": "50 g",
        "add-price": "0.00"
      },
      "m": {
        "size": "100 g",
        "add-price": "0.50"
      },
      "l": {
        "size": "200 g",
        "add-price": "1.00"
      }
    },
    "additives": [
      {
        "name": "Berries",
        "add-price": "0.50"
      },
      {
        "name": "Nuts",
        "add-price": "0.50"
      },
      {
        "name": "Jam",
        "add-price": "0.50"
      }
    ]
  },
  {
    "categories": "dessert",
    "image": "../assets/images/dessert-5.jpg",
    "tittle": "Pancakes",
    "description": "Tender pancakes with strawberry jam and fresh strawberries",
    "price": "4.50",
    "sizes": {
      "s": {
        "size": "50 g",
        "add-price": "0.00"
      },
      "m": {
        "size": "100 g",
        "add-price": "0.50"
      },
      "l": {
        "size": "200 g",
        "add-price": "1.00"
      }
    },
    "additives": [
      {
        "name": "Berries",
        "add-price": "0.50"
      },
      {
        "name": "Nuts",
        "add-price": "0.50"
      },
      {
        "name": "Jam",
        "add-price": "0.50"
      }
    ]
  },
  {
    "categories": "dessert",
    "image": "../assets/images/dessert-6.jpg",
    "tittle": "Honey cake",
    "description": "Classic honey cake with delicate custard",
    "price": "4.50",
    "sizes": {
      "s": {
        "size": "50 g",
        "add-price": "0.00"
      },
      "m": {
        "size": "100 g",
        "add-price": "0.50"
      },
      "l": {
        "size": "200 g",
        "add-price": "1.00"
      }
    },
    "additives": [
      {
        "name": "Berries",
        "add-price": "0.50"
      },
      {
        "name": "Nuts",
        "add-price": "0.50"
      },
      {
        "name": "Jam",
        "add-price": "0.50"
      }
    ]
  },
  {
    "categories": "dessert",
    "image": "../assets/images/dessert-7.jpg",
    "tittle": "Chocolate cake",
    "description": "Cake with hot chocolate filling and nuts with dried apricots",
    "price": "5.50",
    "sizes": {
      "s": {
        "size": "50 g",
        "add-price": "0.00"
      },
      "m": {
        "size": "100 g",
        "add-price": "0.50"
      },
      "l": {
        "size": "200 g",
        "add-price": "1.00"
      }
    },
    "additives": [
      {
        "name": "Berries",
        "add-price": "0.50"
      },
      {
        "name": "Nuts",
        "add-price": "0.50"
      },
      {
        "name": "Jam",
        "add-price": "0.50"
      }
    ]
  },
  {
    "categories": "dessert",
    "image": "../assets/images/dessert-8.jpg",
    "tittle": "Black forest",
    "description":
      "A combination of thin sponge cake with cherry jam and light chocolate mousse",
    "price": "6.50",
    "sizes": {
      "s": {
        "size": "50 g",
        "add-price": "0.00"
      },
      "m": {
        "size": "100 g",
        "add-price": "0.50"
      },
      "l": {
        "size": "200 g",
        "add-price": "1.00"
      }
    },
    "additives": [
      {
        "name": "Berries",
        "add-price": "0.50"
      },
      {
        "name": "Nuts",
        "add-price": "0.50"
      },
      {
        "name": "Jam",
        "add-price": "0.50"
      }
    ]
  },
];

const productList = document.querySelector("[data-product-list]");
const buttonsCategory = document.querySelectorAll("[data-button-category]");
//create current button of category
function activeButton(value){
    let current = '';
    buttonsCategory.forEach((button) => {
            if (value.toUpperCase() == button.innerText.toUpperCase()) {
              button.classList.add("active");
              current = button.innerText.toUpperCase()
            } else {
              button.classList.remove("active");
            }
          });
    return current;
}
// create marcup product
function createMarcup(cardList){
    const markup = cardList.map((item) => `
    <li class="menu-card__item">
    <button class="menu-card__button" data-card-data='${JSON.stringify(item)}'
                      onClick="openModal(this)" type="button">
                    <div class="menu-card__image"><img  src="${item.image}" alt=${item.tittle}></div>
                    <div class="menu-card__description">
                        <div class="menu-card__top">
                            <p class="menu-card__title">${item.tittle}</p>
                            <p class="menu-card__text">${item.description}</p>
                        </div>
                        <div class="menu-card__price">$${item.price}</div>
                    </div>
      </button>            
    </li>
`)
.join("");
productList.innerHTML = markup;
}
// create marcup all product of one category
function filterProduct(value){
    const currentCategory = activeButton(value)
    const cardList = products.filter(cardsCurrent => cardsCurrent.categories.toUpperCase() === currentCategory)
    createMarcup(cardList);
}

window.onload = () => {
   filterProduct("coffee");
};

//work with modal
const modal = document.querySelector("[data-modal]");
const productButtons = document.querySelectorAll(".menu-card__button");
const modalCloseButton = document.querySelectorAll(".modal-content__btn");

productButtons.forEach(button => {button.addEventListener("click", openModal)});
modalCloseButton.forEach(button => { button.addEventListener("click", closeModal)});
modal.addEventListener("click", closeModal);
modal.querySelector('[modal-window]').addEventListener('click', function (e) {
  e.stopPropagation();
});

function openModal(button) {
  modal.classList.remove("is-hidden");
  document.body.classList.add("lock");
  const cardData = JSON.parse(button.getAttribute('data-card-data'));
  contentForModel(cardData);
}

function closeModal(){
  modal.classList.add("is-hidden");
  document.body.classList.remove("lock");

}

// modal with current data of product
const priceProduct = document.querySelector(".modal-content__total--left");

function contentForModel(cardData){
const { image, tittle, description, price, sizes, additives } = cardData;
const imageProduct = document.querySelector('.image-modal');
const titleProduct = document.querySelector('.modal-content__title');
const descriptionProduct = document.querySelector('.modal-content__supTitle');
const sizeList = document.querySelector('[data-size-list]');
const additivesList = document.querySelector('[data-additives-list]');

imageProduct.src = image;
imageProduct.alt = tittle;
titleProduct.textContent = tittle;
descriptionProduct.textContent = description;
additivesList.innerHTML = createMarcupAdditives(additives);
sizeList.innerHTML = createMarcupSizes(sizes);

// Отримуємо перший елемент розміру та встановлюємо клас "selected"
const defaultSizeInput = document.querySelector('input[name="size"]');
defaultSizeInput && defaultSizeInput.parentNode.classList.add('selected');


const basePrice = parseFloat(price);
priceProduct.innerText = `$${basePrice}`;

//work with form of modal
const dataForm = document.querySelector("[data-form]");
dataForm.addEventListener("input", handleInput);

function handleInput(event) {
  const target = event.target;

  // Перевіряємо, чи це інпут розміру або інгредієнта
  if (target.matches('input[name="size"]') || target.matches('input[name="additive"]')) {
    const selectedSize = document.querySelector('input[name="size"]:checked');
    const selectedAdditives = document.querySelectorAll('input[name="additive"]:checked');

    // Видаляємо класи з попереднього вибору
    document.querySelectorAll('.selected').forEach(el => el.classList.remove('selected'));

    // Додаємо класи відповідно до вибраних інгредієнтів та розміру
    selectedSize && selectedSize.parentNode.classList.add('selected');
    selectedAdditives.forEach(additive => additive.parentNode.classList.add('selected'));
    
    // Отримання вартості розміру
    const sizePrice = selectedSize ? parseFloat(selectedSize.value) : 0;

    // Отримання вартості інгредієнтів
    const additivesPrice = Array.from(selectedAdditives).reduce((total, additive) => {
      return total + (additive.checked ? parseFloat(additive.value) : 0);
    }, 0);

    const currentPrice = basePrice + sizePrice + additivesPrice;
      priceProduct.innerText = `$${currentPrice.toFixed(2)}`; // Вивід оновленої ціни в модалці
    
  }
}

}

//  мені потрібно додати функціонал такий, щоб при відкритті модалки клас selected був на розмірі 200 мл, а вже потом можна було змінювати розір і активним ставала та кнопка на яку був клік, підскажи як це можна зробити ?
function createMarcupAdditives(additives) {
  const markup = additives.map(({ name, 'add-price':addPrice }, indx) => `
    <li>
      <label for="${name}" class="choose-label">
        <span>${indx+1}</span>${name}
        <input type="checkbox" name="additive" id="${name}" value="${addPrice}">
      </label>
    </li>
  `)
    .join("");
  return markup;
}
function createMarcupSizes(sizes){
  const card =  Object.entries(sizes);
  const markup = card.map((item) =>`
    <li>
      <label for="${item[1].size}" class="choose-label">
        <span>${item[0].toUpperCase()}</span>${item[1].size}
        <input type="radio"  name="size" id="${item[1].size}" value="${item[1]['add-price']}">
      </label>
    </li>
  `)
    .join("");
  return markup;
}


